import '../../domain/entities/listing.dart';

class ListingModel extends Listing {
  const ListingModel({
    required super.id,
    required super.ownerId,
    required super.title,
    required super.description,
    required super.price,
    super.currency,
    required super.address,
    required super.city,
    required super.state,
    super.country,
    super.latitude,
    super.longitude,
    required super.roomType,
    super.bathroomsCount,
    super.maxOccupants,
    super.availableFrom,
    required super.leaseDuration,
    super.utilitiesIncluded,
    super.wifiIncluded,
    super.parkingIncluded,
    super.furnished,
    super.amenities,
    super.petsAllowed,
    super.smokingAllowed,
    super.guestsAllowed,
    super.isActive,
    super.isFeatured,
    super.imageUrls,
    required super.createdAt,
    required super.updatedAt,
  });

  factory ListingModel.fromJson(Map<String, dynamic> json) {
    return ListingModel(
      id: json['id'] as String,
      ownerId: json['owner_id'] as String,
      title: json['title'] as String,
      description: json['description'] as String,
      price: (json['price'] as num).toDouble(),
      currency: json['currency'] as String? ?? 'USD',
      address: json['address'] as String,
      city: json['city'] as String,
      state: json['state'] as String,
      country: json['country'] as String? ?? 'Ecuador',
      latitude: json['latitude'] != null ? (json['latitude'] as num).toDouble() : null,
      longitude: json['longitude'] != null ? (json['longitude'] as num).toDouble() : null,
      roomType: json['room_type'] as String,
      bathroomsCount: json['bathrooms_count'] as int? ?? 1,
      maxOccupants: json['max_occupants'] as int? ?? 1,
      availableFrom: json['available_from'] != null
          ? DateTime.parse(json['available_from'] as String)
          : null,
      leaseDuration: json['lease_duration'] as String,
      utilitiesIncluded: json['utilities_included'] as bool? ?? false,
      wifiIncluded: json['wifi_included'] as bool? ?? false,
      parkingIncluded: json['parking_included'] as bool? ?? false,
      furnished: json['furnished'] as bool? ?? false,
      amenities: json['amenities'] != null
          ? List<String>.from(json['amenities'] as List)
          : [],
      petsAllowed: json['pets_allowed'] as bool? ?? false,
      smokingAllowed: json['smoking_allowed'] as bool? ?? false,
      guestsAllowed: json['guests_allowed'] as bool? ?? true,
      isActive: json['is_active'] as bool? ?? true,
      isFeatured: json['is_featured'] as bool? ?? false,
      imageUrls: [], // Las im√°genes vienen de otra tabla
      createdAt: DateTime.parse(json['created_at'] as String),
      updatedAt: DateTime.parse(json['updated_at'] as String),
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'owner_id': ownerId,
      'title': title,
      'description': description,
      'price': price,
      'currency': currency,
      'address': address,
      'city': city,
      'state': state,
      'country': country,
      'latitude': latitude,
      'longitude': longitude,
      'room_type': roomType,
      'bathrooms_count': bathroomsCount,
      'max_occupants': maxOccupants,
      'available_from': availableFrom?.toIso8601String(),
      'lease_duration': leaseDuration,
      'utilities_included': utilitiesIncluded,
      'wifi_included': wifiIncluded,
      'parking_included': parkingIncluded,
      'furnished': furnished,
      'amenities': amenities,
      'pets_allowed': petsAllowed,
      'smoking_allowed': smokingAllowed,
      'guests_allowed': guestsAllowed,
      'is_active': isActive,
      'is_featured': isFeatured,
      'created_at': createdAt.toIso8601String(),
      'updated_at': updatedAt.toIso8601String(),
    };
  }

  Listing toEntity() => Listing(
        id: id,
        ownerId: ownerId,
        title: title,
        description: description,
        price: price,
        currency: currency,
        address: address,
        city: city,
        state: state,
        country: country,
        latitude: latitude,
        longitude: longitude,
        roomType: roomType,
        bathroomsCount: bathroomsCount,
        maxOccupants: maxOccupants,
        availableFrom: availableFrom,
        leaseDuration: leaseDuration,
        utilitiesIncluded: utilitiesIncluded,
        wifiIncluded: wifiIncluded,
        parkingIncluded: parkingIncluded,
        furnished: furnished,
        amenities: amenities,
        petsAllowed: petsAllowed,
        smokingAllowed: smokingAllowed,
        guestsAllowed: guestsAllowed,
        isActive: isActive,
        isFeatured: isFeatured,
        imageUrls: imageUrls,
        createdAt: createdAt,
        updatedAt: updatedAt,
      );
}